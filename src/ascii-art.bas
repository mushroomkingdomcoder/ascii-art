#RetroDevStudio.MetaData.BASIC:2049,BASIC V2,uppercase,10,10
1 POKE55,0:POKE56,96:CLR:PRINT"ASCII ART VERSION 1.0":OPEN1,8,15,"I":CLOSE1
2 PRINTCHR$(8):POKE53269,0:POKE53270,PEEK(53270)AND239:GOSUB4:GOTO378
3 PRINT"":POKE53280,BC:POKE53281,BC:     POKE646,PC:GOTO7
4 V=53248:S=54272:J=56320:SB=26624:VB=16384:CB=24576:C=28672:PB=27648:SP=27640
5 R=160:A=42:P=32
6 RETURN
7 DIM TL(7)
8 FORI=0TO7:READTL(I):NEXT
9 GOTO413
10 GOSUB372
11 PRINT"SINGULAR COLOR OR MULTICOLOR IMAGE ?    ";
12 GOSUB374:IFZ$="S"THENMF=0:GOTO15
13 IFZ$="M"THENMF=1:GOTO15
14 GOTO12
15 X=MF+1:PRINT"SINGLE CHARACTER IMAGE OR TILED IMAGE ?"
16 GOSUB374:IFZ$="S"THENTF=0:GOTO19
17 IFZ$="T"THENTF=1:GOTO19
18 GOTO16
19 IFTF<>1THENXX=1:YY=1:GOTO21
20 PRINT"DIMENSIONS ?  (1,1)   (X,Y)             ";:XP=SB+15:GOSUB259
21 PRINT"":A=42:GOSUB256:GOSUB282
22 D1=XX*YY:D2=XX*YY-1:GOSUB338
23 ON X GOSUB 367,362
24 PRINT"FREE DRAW OR ASSIGNED DRAW ? (NOT FINAL)";
25 GOSUB374:IFZ$="F"THENDF=0:GOTO29
26 IFZ$="A"THENDF=1:GOTO28
27 GOTO25
28 GOSUB286
29 GOSUB349
30 GOSUB372:PRINT"PROCESSING..."
31 GOSUB481
32 POKEV,PX:POKEV+1,PY
33 GETZ$:POKEV+39,16*RND(1)
34 IFZ$=""THENPY=PY-8:GOTO58
35 IFZ$=""THENPX=PX+SD:GOTO58
36 IFZ$=""THENPY=PY+8:GOTO58
37 IFZ$=""THENPX=PX-SD:GOTO58
38 IFZ$=" "THEN66
39 IFZ$=""THEN89
40 IFZ$=""ANDMF=1THEN91
41 IFZ$=""ANDMF=1THEN93
42 IFZ$=""THEN95
43 IFZ$=""THEN183
44 IFZ$="A"ANDDF=0THEN97
45 IFZ$=""THEN101
46 IFZ$=""ANDMF=1THENAN=0:GOTO115
47 IFZ$=""ANDMF=1THEN130
48 IFZ$="E"THEN132
49 IFZ$="F"THEN135
50 IFZ$="R"THEN145
51 IFZ$="U"ANDDF=1THEN149
52 IFZ$="S"THEN152
53 IFZ$="L"THEN167
54 IFZ$="N"THEN172
55 IFZ$="Q"THEN173
56 IFZ$=""THEN179
57 GOTO33
58 IFPY<UYTHENPY=LY:GOTO62
59 IFPX<LXTHENPX=RX:GOTO62
60 IFPX>RXTHENPX=LX:GOTO62
61 IFPY>LYTHENPY=UY
62 SN=1:GOSUB239:SN=2
63 POKEV,FX:POKEV+1,PY
64 CX=0:CY=0
65 GOTO33
66 GOSUB346:GOSUB341
67 POKEB1,DW:POKEB1+C,CC(CH)
68 IFMF=1THENPOKEB2,DW:POKEB2+C,CC(CH)
69 IFDF<>1THEN32
70 BY=(CB+(CH(INT(CH))*8))+LN
71 IFMF=1THEN75
72 CM=ABS(CM-7):IFDW=Z0THENPOKEBY,PEEK(BY)OR2CM:GOTO74
73 POKEBY,PEEK(BY)AND255-2CM
74 GOTO33
75 CM=INT(CM/2)*2:CM=ABS(CM-6)
76 IFDW=Z0THENGOSUB80:GOTO88
77 IFDW=Z1THENGOSUB82:GOTO88
78 IFDW=Z2THENGOSUB84:GOTO88
79 IFDW=Z3THENGOSUB86:GOTO88
80 POKEBY,PEEK(BY)OR(2CM):                POKEBY,PEEK(BY)OR(2(CM+1))
81 RETURN
82 POKEBY,PEEK(BY)OR(2CM):                POKEBY,PEEK(BY)AND(255-(2(CM+1)))
83 RETURN
84 POKEBY,PEEK(BY)AND(255-(2CM)):         POKEBY,PEEK(BY)OR(2(CM+1))
85 RETURN
86 POKEBY,PEEK(BY)AND(255-(2CM)):         POKEBY,PEEK(BY)AND(255-(2(CM+1)))
87 RETURN
88 GOTO33
89 DW=Z0
90 GOTO33
91 DW=Z1
92 GOTO33
93 DW=Z2
94 GOTO33
95 DW=Z3
96 GOTO33
97 DF=1
98 GOSUB286:IFEF=1THENDF=0
99 PRINTMS$(MS);
100 GOTO33
101 GOSUB372:POKEV+21,0:CD=0:PK=Z0
102 GOSUB372:PRINT"SELECT IMAGE COLOR."
103 ZX=XX*8+3:ZY=4:SN=2:GOSUB370:PX=ZX: PY=ZY:QX=320:QY=186:BN=BN-1:POKEV+21,2
104 IFMF=1THENZX=XX*8+3:ZY=11:GOSUB370:PY=ZY
105 GOSUB215:IFKS=2THEN112
106 IFKS=1THENFORL=0TOD2:GOSUB224:CR=PEEK(XP+C):GOSUB211:GOSUB225:GOSUB230:NEXT
107 IFPX<ZXTHENPX=ZX:GOTO111
108 IFPX>QXTHENPX=QX:GOTO111
109 IFPY<ZYTHENPY=ZY:GOTO111
110 IFPY>QYTHENPY=QY
111 GOSUB239:POKEV+2,FX:POKEV+3,PY:GOTO105
112 POKEV+21,1:PRINTMS$(MS);
113 PX=LX:PY=UY
114 GOTO32
115 GOSUB372:POKEV+21,0:CD=0:POKEV+22,PEEK(V+22)AND239
116 PRINT"SELECT AUXILLARY COLOR."
117 ZX=XX*8+3:ZY=4:SN=2:GOSUB370:PX=ZX:     PY=ZY:QX=320:QY=186:POKEV+21,2
118 GOSUB215
119 IFKS=1THENGOSUB224:AC=PEEK(XP+C)AND15:POKEV+34+AN,AC:GOTO118
120 IFKS=2THEN126
121 IFPX<ZXTHENPX=ZX:GOTO125
122 IFPY<ZYTHENPY=ZY:GOTO125
123 IFPX>QXTHENPX=QX:GOTO125
124 IFPY>QYTHENPY=QY
125 GOSUB239:POKEV+2,FX:POKEV+3,PY:         GOTO118
126 POKEV+22,PEEK(V+22)OR16
127 PRINTMS$(MS);:POKEV+21,1
128 PX=LX:PY=UY
129 GOTO32
130 AN=1:GOTO115
131 GOTO32
132 PK=P:P1=SB+81:SF=0
133 ON X GOSUB 242,194
134 GOTO33
135 PK=R:P1=SB+81:SF=0
136 IFMF=1THEN138
137 ON X GOSUB 242,194:GOTO143
138 GOSUB372:PRINT"WHICH COLOR (USE FUNCTION KEYS)"
139 GOSUB374:IFZ$=""THENPK=Z0:GOTO137
140 IFZ$=""THENPK=Z1:GOTO137
141 IFZ$=""THENPK=Z2:GOTO137
142 GOTO139
143 PRINTMS$(MS);
144 GOTO33
145 SF=1:P1=SB+81
146 ON X GOSUB 242,194
147 SF=0
148 GOTO33
149 DF=0
150 FORI=0TOD2:CS(CH(I))=0:NEXT
151 GOTO33
152 GOSUB448
153 PRINT"OK. SAVING... PLEASE WAIT.":IFDV=8THEN158
154 PRINT"";:OPEN 1,1,1
155 FORI=CBTOCB+2047:BY=PEEK(I)
156 PRINT# 1,CHR$(BY);:NEXT
157 CLOSE 1:GOTO165
158 OPEN 15,8,15:OPEN 1,8,2,"#"
159 PRINT# 15,"B-P 2 0"
160 FORI=0TO7:SS=CB+I*256:FORK=SSTOSS+255:PRINT# 1,CHR$(PEEK(K));:NEXTK
161 PRINT# 15,"U2 2 0 1";I:NEXTI
162 GOSUB478
163 CLOSE 1:CLOSE 15
164 DR=1000:GOSUB373
165 PRINTMS$(MS);
166 GOTO33
167 GOSUB448:GOSUB459
168 IFDF=0THEN170
169 GOSUB372:PRINT"ASSIGN OR ERASE GRID DATA ?":GOSUB293
170 PRINTMS$(MS);
171 GOTO33
172 GOTO10
173 PRINT"ARE YOU SURE YOU WISH TO EXIT THE ...   ":DR=2000:GOSUB373
174 PRINT"EDITOR?  Y/N (ALL CURRENT CHARCTER ...  ":DR=2500:GOSUB373
175 GOSUB372:PRINT"DATA WILL STAY INTACT.) Y/N":GOSUB374:IFZ$<>"Y"THEN177
176 PRINT"BYE!":POKEV+21,0:END
177 PRINTMS$(MS);
178 GOTO33
179 MS=MS+1
180 IFMS>21THENMS=0
181 PRINTMS$(MS);
182 GOTO33
183 PRINT"SELECT BACKGROUD COLOR WITH CRSR KEYS.";:BG=PEEK(V+33)
184 GETZ$:POKEV+33,BG
185 IFZ$=""THENBG=BG+1:GOTO189
186 IFZ$=""THENBG=BG-1:GOTO189
187 IFZ$=CHR$(13)THEN192
188 GOTO184
189 IFBG<0THENBG=15
190 IFBG>15THENBG=0
191 GOTO184
192 PRINTMS$(MS)
193 GOTO33
194 FORI=0TOYY*8-1:FORK=0TOXX*8-2STEP2:X1=P1+I*40+K:X2=X1+1:C1=X1+C:C2=X2+C
195 ON SF+1 GOTO 198,196,197
196 XP=X1:GOSUB252:GOTO198
197 CH=INT(I/8)*XX+INT(K/8):PK=PEEK(X1):GOTO200
198 POKEX1,PK:POKEX2,PK:CH=INT(I/8)*XX+INT(K/8):CR=CC(CH):POKEC1,CR:POKEC2,CR
199 IFDF=0THENNEXTK:NEXTI:RETURN
200 XP=X1-SB:W=CH(CH)*8+CB:CY=2:CX=1+CH*8:ZY=INT(XP/40):ZX=XP-ZY*40
201 IFCH+1>XXTHENCY=10:CX=CX-XX*8
202 LN=ZY-CY:CM=ZX-CX:BY=W+LN:              CM=ABS(CM-6)
203 IFPK=Z0THENGOSUB207:NEXTK:NEXTI:        RETURN
204 IFPK=Z1THENGOSUB208:NEXTK:NEXTI:        RETURN
205 IFPK=Z2THENGOSUB209:NEXTK:NEXTI:        RETURN
206 IFPK=Z3THENGOSUB210:NEXTK:NEXTI:        RETURN
207 POKEBY,PEEK(BY)OR2CM:                  POKEBY,PEEK(BY)OR2(CM+1):RETURN
208 POKEBY,PEEK(BY)OR2CM:              POKEBY,PEEK(BY)AND255-2(CM+1):RETURN
209 POKEBY,PEEK(BY)AND255-2CM:             POKEBY,PEEK(BY)OR2(CM+1):RETURN
210 POKEBY,PEEK(BY)AND255-2CM:         POKEBY,PEEK(BY)AND255-2(CM+1):RETURN
211 IFMF=1THEN:IFCR<8THENCR=CR+8
212 BN=L
213 CC(BN)=CR
214 RETURN
215 GETZ$:POKEV+38+SN,16*RND(1)
216 IFZ$=""THENPY=PY-8:RETURN
217 IFZ$=""THENPX=PX+8:RETURN
218 IFZ$=""THENPY=PY+8:RETURN
219 IFZ$=""THENPX=PX-8:RETURN
220 IFZ$=" "THENKS=1:RETURN
221 IFZ$=CHR$(13)THENKS=2:RETURN
222 IFZ$=CHR$(CD)THENKS=3:RETURN
223 KS=0:RETURN
224 XP=SB+(((PY-50)/8)*40)+((PX-24)/8):     RETURN
225 P1=SB+81+BN*8
226 IFBN+1>XXTHENP1=P1+320-XX*8
227 FORI=P1TOP1+280STEP40:FORK=0TO7:        IFPEEK(I+K)=RTHENPOKEI+K+C,CR
228 NEXTK:NEXTI
229 RETURN
230 P1=SB+882:GOSUB234
231 FORI=0TO2:FORK=0TO2
232 P1=SB+769+(I*(YY*40))+(K*XX)
233 GOSUB234:NEXTK:NEXTI:RETURN
234 RW=0:CM=BN
235 IFBN+1>XXTHENRW=1:CM=CM-XX
236 XP=P1+RW*40+CM
237 POKEXP+C,CR
238 RETURN
239 FX=PX:IFPX>255THENFX=PX-256:            POKEV+16,SN
240 IFPX<256THENPOKEV+16,0
241 RETURN
242 FORI=0TOYY*8-1:FORK=0TOXX*8-1:XP=P1+I*40+K:ON SF+1 GOTO 245,243,244
243 GOSUB252:GOTO245
244 CH=INT(I/8)*XX+INT(K/8):PK=PEEK(XP):GOTO247
245 POKEXP,PK:CC=XP+C:CH=INT(I/8)*XX+INT(K/8):CR=CC(CH):POKECC,CR
246 IFDF=0THENNEXTK:NEXTI:RETURN
247 W=CH(CH)*8+CB:CY=2:CX=1+CH*8:XP=XP-SB:ZY=INT(XP/40):ZX=XP-ZY*40
248 IFCH+1>XXTHENCY=10:CX=CX-XX*8
249 LN=ZY-CY:CM=ZX-CX:BY=W+LN:CM=ABS(CM-7)
250 IFPK=RTHENPOKEBY,PEEK(BY)OR2CM:NEXTK:NEXTI:RETURN
251 IFPK=PTHENPOKEBY,PEEK(BY)AND255-2CM:NEXTK:NEXTI:RETURN
252 IFPEEK(XP)=Z0THENPK=Z3:RETURN
253 IFPEEK(XP)=Z3THENPK=Z0:RETURN
254 IFPEEK(XP)=Z1THENPK=Z2:RETURN
255 IFPEEK(XP)=Z2THENPK=Z1:RETURN
256 P1=SB+41:P2=P1+XX*8:ZZ=1:PK=A:CR=PC:GOSUB376:P1=P2+40:P2=P1+YY*8*40:ZZ=40
257 GOSUB376:P1=P2-1:P2=P1-XX*8:ZZ=-1:GOSUB376:P1=P2-40:P2=P1-YY*8*40:ZZ=-40
258 GOSUB376:RETURN
259 POKEXP+C,8*RND(1):DM=PEEK(XP)-48
260 GETZ$:IFZ$=""THENDM=DM+1:GOTO266
261 IFZ$=""THENXP=XP+2:POKEXP-2+C,PC:      GOTO266
262 IFZ$=""THENDM=DM-1:GOTO266
263 IFZ$=""THENXP=XP-2:POKEXP+2+C,PC:      GOTO266
264 IFZ$<>CHR$(13)THENGOTO259
265 GOTO273
266 IFXP>SB+17THENXP=SB+15
267 IFXP<SB+15THENXP=SB+17
268 IFDM>4ANDXP=SB+15THENDM=1
269 IFDM>2ANDXP=SB+17THENDM=1
270 IFDM<1ANDXP=SB+15THENDM=4
271 IFDM<1ANDXP=SB+17THENDM=2
272 POKEXP,DM+48:GOTO259
273 XX=PEEK(SB+15)-48
274 YY=PEEK(SB+17)-48
275 RETURN
276 GOSUB372:PRINT"PROCESSING..."
277 EF=0
278 FORI=0TOD2
279 IFCH(I)=Z0ORCH(I)=Z3OR(CH(I)=Z1ANDMF=1)OR(CH(I)=Z2ANDMF=1)THENEF=1
280 NEXT:GOSUB372
281 RETURN
282 PRINT"****************************************COLOR:";
283 P1=SB+120+XX*8+2:FORI=0TO15:            IFI=BCTHENNEXTI
284 FORK=0TO37-XX*8:POKEP1+K,R:POKEP1+K+C,I:NEXTK:P1=P1+40:NEXTI
285 PRINT"****************************************";:RETURN
286 GOSUB372:PRINT"ASSIGN IMAGE TO WHICH CHARACTERS ?":DR=2000:GOSUB373
287 PRINT"EDIT WITH CRSR KEYS, O OR PRESS RETURN.";:DR=2000:GOSUB373
288 EF=0:GOSUB372:GOSUB312:GOSUB296:IFEF=1THEN295
289 GOSUB276:IFEF=0THEN291
290 PRINT"INAVILD INPUT! (160,32,0, AND/OR 28)    ";:DR=2000:GOSUB373:GOTO288
291 GOSUB355:GOSUB349:GOSUB325:GOSUB372:PRINT"ASSIGN OR ERASE GRID DATA?";
292 GOSUB374:IFZ$="E"THENGOSUB320:RETURN
293 IFZ$<>"A"THEN292
294 SF=2:P1=SB+81:ONXGOSUB242,194:SF=0:FORL=0TO3:CR=CC(L):GOSUB230:NEXT:RETURN
295 DF=0:RETURN
296 L1=SB+1:L2=SB+(D2)*2+1:XP=L1
297 POKEXP+C,8*RND(1):DT=(XP-L1)/2:PRINT"";CH(DT);"  ";
298 GETZ$:IFZ$=""THENCH(DT)=CH(DT)+1:      GOTO304
299 IFZ$=""THENPOKEXP+C,PC:                XP=XP+2:GOTO304
300 IFZ$=""THENCH(DT)=CH(DT)-1:GOTO304
301 IFZ$=""THENPOKEXP+C,PC:                XP=XP-2:GOTO304
302 IFZ$=CHR$(13)THEN309
303 GOSUB472:IFKS=0THEN297
304 IFCH(DT)>255THENCH(DT)=0
305 IFCH(DT)<0THENCH(DT)=255
306 IFXP<L1THENXP=L2
307 IFXP>L2THENXP=L1
308 DT=(XP-L1)/2:POKEXP,CH(DT):GOTO297
309 GOSUB372:PRINT"PROCESSING...";:FORI=0TO(L2-L1)/2:FORK=0TO(L2-L1)/2
310 IFK<>ITHENIFCH(I)=CH(K)THENEF=1
311 NEXTK:NEXTI:RETURN
312 PRINT"(";:FORI=0TOD2*2STEP2
313 IFI=D2*2THENPOKESB+I+1,CH(I/2):POKESB+I+1+C,PC:PRINT")";:GOTO315
314 POKESB+I+1,CH(I/2):POKESB+I+1+C,PC:     PRINT",";:NEXT
315 RETURN
316 FORZ=0TOYY-1:FORQ=0TOXX-1:CH=Z*XX+Q
317 XP=P1+Z*40+Q:PK=Z*XX+Q
318 POKEXP,CH(PK):POKEXP+C,CC(CH):NEXTQ
319 NEXTZ:RETURN
320 P1=SB+81:FORI=0TOD2:CR=CC(I)
321 PK=CH(I):ON X GOSUB 357,329
322 IFI=XX-1THENP1=P1-(XX-1)*8:NEXT:        RETURN
323 P1=P1-312:NEXT
324 RETURN
325 P1=SB+882:GOSUB316
326 FORI=0TO2:FORK=0TO2
327 P1=SB+769+(I*(YY*40))+(K*XX)
328 GOSUB316:NEXTK:NEXTI:RETURN
329 W=CB+PK*8:FORK=0TO7:BY=W+K:FORZ=6TO0STEP-2
330 IC=ABS(Z-6):K1=P1+IC:K2=P1+1+IC:C1=K1+C:C2=K2+C:W1=2Z:W2=2(Z+1)
331 B1=PEEK(BY)ANDW1:B2=PEEK(BY)ANDW2
332 IFB1=W1ANDB2=W2THENPOKEK1,Z0:POKEK2,Z0:GOSUB336:NEXTZ:P1=P1+40:NEXTK:RETURN
333 IFB1=W1ANDB2=0THENPOKEK1,Z1:POKEK2,Z1:GOSUB336:NEXTZ:P1=P1+40:NEXTK:RETURN
334 IFB1=0ANDB2=W2THENPOKEK1,Z2:POKEK2,Z2:GOSUB336:NEXTZ:P1=P1+40:NEXTK:RETURN
335 POKEK1,Z3:POKEK2,Z3:GOSUB336:NEXTZ:     P1=P1+40:NEXTK:RETURN
336 POKEC1,CR:POKEC2,CR:RETURN
337 END
338 REM NO DIM
339 FORI=0TOD2:CH(I)=I:NEXT
340 RETURN
341 CH=INT((PY-UY)/64)*XX+INT((PX-LX)/64)
342 CY=UY:IFCH+1>XXTHENCY=130
343 LN=(PY-CY)/8:CX=LX+CH*64:IFCH+1>XX      THENCX=CX-XX*64
344 CM=(PX-CX)/8
345 RETURN
346 B1=SB+((PX-24)/8)+((PY-50)/8)*40
347 B2=B1:IFMF=1THENB2=B1+1
348 RETURN
349 PRINT"PREVIEW:/PRESS  TO";
350 PRINT"/TOGGLE BETWEEN/INFO ON TOP LINE";
351 PRINT"/////////////////";
352 GOSUB372:RETURN
353 FORI=SB+40TOSB+799:POKEI,96:NEXT
354 RETURN
355 FORI=SB+760TOSB+999:POKEI,32:NEXT
356 RETURN
357 W=CB+PK*8:FORK=0TO7:BY=W+K:BK=P1:FORZ=7TO0STEP-1:BT=PEEK(BY)AND2Z
358 IFBT<>0THENPOKEBK,R:POKEBK+C,CR
359 IFBT=0THENPOKEBK,P
360 BK=BK+1:NEXTZ:P1=P1+40:NEXTK
361 RETURN
362 POKE53270,PEEK(53270)OR16
363 Q1=CB+Z1*8:Q2=CB+Z2*8
364 FORI=Q1TOQ1+7:POKEI,85:NEXT:            FORI=Q2TOQ2+7:POKEI,170:NEXT
365 POKEV+34,13:POKEV+35,14:FORI=0TOD2:CC(I)=PC+8:NEXT
366 RETURN
367 POKE53270,PEEK(53270)AND239
368 FORI=0TOD2:CC(I)=PC:NEXT
369 RETURN
370 ZX=(ZX-1)*8+24:ZY=(ZY-1)*8+50
371 RETURN
372 PRINT"                                        ";:RETURN
373 FORT=1TODR:NEXT:RETURN
374 GETZ$:IFZ$=""THEN374
375 RETURN
376 FORI=P1TOP2STEPZZ:POKEI,PK:POKEI+C,CR:NEXT:RETURN
377  END
378 PRINT"    IS THIS THE FIRST TIME RUNNING THIS"
379 PRINT"PROGRAM SINCE POWER-UP?"
380 PRINT"    THE VIDEO RAM OF YOUR PC MUST BE  "
381 PRINT"INITIALIZED BEFORE PROGRESSING ANY     "
382 PRINT"FURTHER IF YOU HAVE NOT ALREADY. FAILURE";
383 PRINT"TO DO SO WILL RESULT IN THE            "
384 PRINT"DISFUNCTIONALITY OF THIS PROGRAM AS WELL";
385 PRINT"AS POTENTIAL COMPUTER LOCK-UP, FORCING "
386 PRINT"YOU TO RESET YOUR PC. IF THIS IS THE   "
387 PRINT"FIRST TIME THAT YOU HAVE RUN THIS      "
388 PRINT"PROGRAM SINCE POWER-UP, THEN PRESS Y OR"
389 PRINT"I TO INITIALIZE YOU PC'S VIDEO RAM.    "
390 PRINT"    OTHERWISE, PRESS ANY OTHER KEY TO "
391 PRINT"CONTINUE RUNNING THE SOFTWARE.":PRINT
392 GOSUB374
393 IFZ$<>"Y"ANDZ$<>"I"THEN405
394 PRINT"OK... INITIALIZING..."
395 PRINT"     PLEASE WAIT ABOUT 35 SECONDS..."
396 POKE56334,PEEK(56334)AND254
397 POKE1,PEEK(1)AND251
398 FORI=0TO2047
399 POKE24576+I,PEEK(53248+I):NEXT
400 POKE1,PEEK(1)OR4
401 POKE56334,PEEK(56334)OR1
402 POKE53272,(PEEK(53272)AND15)OR160
403 POKE53272,(PEEK(53272)AND240)OR8
404 POKE56576,6:POKE648,104
405 PRINT"NIGHT OR DAY MODE ?"
406 GOSUB374:IFZ$="D"THENBC=1:PC=0         :GOTO409
407 IFZ$="N"THENBC=0:PC=1:GOTO409
408 GOTO406
409 PRINT"LOAD A CUSTOM CHARACTER SET ? (Y/N) "
410 GOSUB374:IFZ$<>"Y"THEN412
411 GOSUB448:GOSUB459
412 GOTO3
413 PRINT""
414 P1=SB+80:CR=PC:FORI=0TO4
415 PK=TL(I):GOSUB357:P1=P1-312:CR=CR+1:IFCR=BCTHENCR=CR+1
416 NEXT:P1=SB+448:FORI=5TO7
417 PK=TL(I):GOSUB357:P1=P1-312:CR=CR+1:NEXT:PRINT"";
418 DR=1000:GOSUB373
419 PRINT"A CUSTOMTEXT & TILE EDITOR."
420 DR=2000:GOSUB373
421 PRINT"     * DEVELOPED BY FRANCIS DESANY *    ":DR=2000:GOSUB373
422 GETZ$:IFZ$<>""THEN427
423 PRINT"           * AUGUST 28, 2019 *          ":DR=1500:GOSUB373
424 GETZ$:IFZ$<>""THEN427
425 PRINT"            * VERSION 1.0 *             ":DR=1000:GOSUB373
426 GETZ$:IFZ$=""THEN421
427 PRINT"LOADING PROGRAM DATA...                 ";
428 GOSUB429:GOTO10
429 V=53248:POKESP,176:POKESP+1,177
430 FORI=PBTOPB+23STEP3:POKEI,255:POKEI+1,0:POKEI+2,0:NEXT:FORI=PB+23TOPB+62
431 POKEI,0:NEXT
432 MF=0:TF=0:XX=0:YY=0:DF=0:SF=0:EF=0
433 XP=SB+15
434 DIM MS$(21)
435 POKEV+37,PC:POKEV+38,PC
436 P1=VB+177*64:P2=P1+62:FORI=P1TOP2       :READA:POKEI,A:NEXT
437 P1=VB+178*64:P2=P1+23:P3=P1+62:          FORI=P1TOP2STEP3
438 POKEI,255:POKEI+1,255:POKEI+2,0:        NEXT
439 FORI=P2+1TOP3:POKEI,0:NEXT
440 PX=32:PY=66
441 POKEV+21,0
442 FORI=39TO45:POKEV+I,PC:NEXT
443 FORI=0TO14STEP2:POKEV+I,PX:POKEV+I+1,PY:NEXT
444 POKEV+29,0:POKEV+23,0:POKEV+28,0:       POKEV+16,2
445 Z0=160:Z1=0:Z2=28:Z3=32
446 GOSUB488
447 RETURN
448 GOSUB372:PRINT"TAPE OR DISK ?"
449 GOSUB374:IFZ$="T"THENDV=1:GOTO452
450 IFZ$="D"THENDV=8:RETURN
451 GOTO449
452 GOSUB372:PRINT"FILENAME ?";
453 PRINT"";FL$;" ":          GOSUB374
454 IFZ$=""ORZ$=""ORZ$=""ORZ$=""ORZ$=""ORZ$=""ORZ$=""THEN453
455 IFZ$=CHR$(13)THEN458
456 IFZ$=""THENFL$="":GOTO453
457 FL$=FL$+Z$:GOTO453
458 RETURN
459 PRINT"OK. LOADING... PLEASE WAIT.":IFDV=8THEN465
460 PRINT"";
461 OPEN 1,1,0
462 FORI=CBTOCB+2047
463 GET# 1,BY$:POKEI,ASC(BY$+CHR$(0)):NEXT
464 CLOSE 1:RETURN
465 OPEN 15,8,15:OPEN 1,8,2,"#"
466 FORI=0TO7:PRINT# 15,"B-P 2 0"
467 SS=CB+I*256:PRINT# 15,"U1 2 0 1";I:FORK=SSTOSS+255:GET# 1,BY$
468 POKEK,ASC(BY$+CHR$(0)):NEXTK:NEXTI:GOSUB478
469 CLOSE 1:CLOSE 15
470 DR=2000:GOSUB373
471 RETURN
472 IFZ$="."THENCH(DT)=CH(DT)+10:KS=1:      RETURN
473 IFZ$="/"THENCH(DT)=CH(DT)-10:KS=1:      RETURN
474 IFZ$="O"THENFORI=1TOD2:CH(I)=CH(0)+I:GOSUB476:POKESB+I*2+1,CH(I):NEXT
475 KS=0:RETURN
476 IFCH(I)>255THENCH(I)=CH(I)-256
477 RETURN
478 GOSUB372:PRINT"";
479 GET# 15,A$:PRINTA$;:IFST=0THEN479
480 PRINT:RETURN
481 PP=176:IFMF=1THENPP=178
482 SD=8:IFMF=1THENSD=16
483 UY=66:LY=YY*64+UY-8:                    LX=32:RX=XX*64+LX-SD
484 POKESP,PP:ZX=2:ZY=3:SN=0:GOSUB370
485 PX=ZX:PY=ZY:DW=Z0:MS=0
486 POKEV+39,PC:POKEV+21,1:PRINTMS$(MS);
487 RETURN
488 MS$(0)="USE CRSR KEYS WITH SPACE BAR TO EDIT ..."
489 MS$(1)="F1 = USE IMAGE COLOR ...                "
490 MS$(2)="F2 = SELECT IMAGE COLOR ...             "
491 MS$(3)="F3 = USE AUX. #1, IF APPLICABLE ...     "
492 MS$(4)="F4 = SELECT AUX. #1, IF APPLICABLE ...  "
493 MS$(5)="F5 = USE AUX. #2, IF APPLICABLE ...     "
494 MS$(6)="F6 = SELECT AUX. #2, IF APPLICABLE ...  "
495 MS$(7)="F7 = USE ERASER ...                     "
496 MS$(8)="F8 = SELECT BACKGROUND COLOR ...        "
497 MS$(9)="E = ERASE IMAGE ...                     "
498 MS$(10)="F = FILL IMAGE WITH COLOR ...           "
499 MS$(11)="R = REVERSE IMAGE ...                   "
500 MS$(12)="A = ASSIGN IMAGE ...                    "
501 MS$(13)="U = UNASSIGN IMAGE ...                  "
502 MS$(14)="S = SAVE WHOLE CHARACTER SET ...        "
503 MS$(15)="L = LOAD A SAVED CHARACTER SET ...      "
504 MS$(16)="N = NEW IMAGE ...                       "
505 MS$(17)="Q = QUIT EDITOR ...                     "
506 MS$(18)="RETURN = EXIT MENUS AND SUB-MENUS ...   "
507 MS$(19)="    * DEVELEOPED BY FRANCIS DESANY *    "
508 MS$(20)="           * AUGUST 28, 2019 *          "
509 MS$(21)="            * VERSION 1.0 *             "
510 RETURN
511 DATA 1,19,3,9,9,1,18,20
512 DATA 192,0,0,240,0,0,127,0,0,127,240,0,63,255,0,63,255,0,63,254,0,63,252,0
513 DATA 31,248,0,31,248,0,31,252,0,31,254,0,15,255,0,15,63,128,14,31,192
514 DATA 12,15,224,0,7,224,0,3,192,0,1,128,0,0,0,0,0,0
